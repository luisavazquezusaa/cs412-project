<!-- File: create_listing_form.html
Author: Luisa Vazquez Usabiaga (lvu@bu.edu), 12/03/2025
Description: Template for creating a new listing, including photo uploads and Google-address autocomplete.
-->

<!-- project/create_listing_form.html -->
{% extends 'project/base.html' %}
{% load static %}

{% block content %}
<h1>Create Listing</h1>

<div class="form-card">
    <form action="{% url 'create_listing' %}" method="POST" enctype="multipart/form-data" class="form-stacked">
        {% csrf_token %}
        {{ form.as_p }}

        <h3>Add Photos</h3>
        <input type="file" name="image_files" multiple>

        <button type="submit" class="primary-btn full-width">Create Listing</button>
    </form>
</div>

<!-- Address through Google Autocomplete -->
<script>
    function initAutocomplete() {
        const input = document.getElementById("id_address");
        const autocomplete = new google.maps.places.Autocomplete(input);
    
        autocomplete.addListener("place_changed", () => {
            const place = autocomplete.getPlace();
    
            if (place.geometry) {
                document.getElementById("id_latitude").value = place.geometry.location.lat();
                document.getElementById("id_longitude").value = place.geometry.location.lng();
            }
        });
    }
    
    window.onload = initAutocomplete;
    </script>
    

{% endblock %}

